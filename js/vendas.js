// VENDAS
let vendas = [{
    nome: 'Juliano',
    data: 06/01/2024,
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Candida',
    data: 06/01/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Kelly',
    data: 07/01/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: 19/01/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Carlinhos',
    data: 19/01/2024,
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: 19/01/2024,
    compra: 'Trapiche',
    quantidade: 1,
    valorCompra: 45,
    valorVenda: 60
},
{
    nome: 'Carlinhos',
    data: 19/01/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: 20/01/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: 21/01/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Candida',
    data: 03/02/2024,
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: 09/02/2024,
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: 10/02/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: 10/02/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: 21/01/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Carlinhos',
    data: 11/02/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: 11/12/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: 11/12/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: 02/03/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: 13/03/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: 13/03/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: 25/03/2024,
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: 14/04/2024,
    compra: 'Chac Chac - Rose',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: 14/04/2024,
    compra: 'Chac Chac - Rose',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: 14/04/2024,
    compra: 'Casillero Del Diablo',
    quantidade: 1,
    valorCompra: 45,
    valorVenda: 65
},
{
    nome: 'Carlinhos',
    data: 14/04/2024,
    compra: 'Granja União',
    quantidade: 1,
    valorCompra: 25,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: 09/04/2024,
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: 09/04/2024,
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: 09/04/2024,
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: 09/04/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: 09/04/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: 09/04/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: 09/04/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Candida',
    data: 20/04/2024,
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Granja União',
    quantidade: 1,
    valorCompra: 25,
    valorVenda: 35
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Carlinhos',
    data: 12/05/2024,
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Candida',
    data: 12/05/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Camille',
    data: 12/05/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Camille',
    data: 12/05/2024,
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
}];

// INFO USUARIOS
let arrayObjetos = [{
    nome: 'Carlinhos',
    avatar: './img/carlinhos.jpeg',
    valorGasto: 825
},
{
    nome: 'Candida',
    avatar: './img/candida.jpeg',
    valorGasto: 310
},
{
    nome: 'Candice',
    avatar: './img/candice.jpeg',
    valorGasto: 640
},
{
    nome: 'Camille',
    avatar: './img/camille.png',
    valorGasto: 60
},
{
    nome: 'Juliano',
    avatar: './img/juliano.jpeg',
    valorGasto: 55
},
{
    nome: 'Kelly',
    avatar: './img/kelly.jpeg',
    valorGasto: 35
},
{
    nome: 'Lucas',
    avatar: './img/lucas.png',
    valorGasto: 0
}]

function mesclarArrays(vendas, arrayObjetos, nome) {
    return vendas.map(objeto1 => {
      const objeto2 = arrayObjetos.find(objeto2 => objeto2[nome] === objeto1[nome]);
  
      // Se encontrou um objeto correspondente, mescla os objetos
      if (objeto2) {
        return { ...objeto1, ...objeto2 };
      }
  
      // Se não encontrou correspondência, retorna o objeto original
      return objeto1;
    });
  }

const resultado = mesclarArrays(vendas, arrayObjetos, 'nome');

let listaOrdenada = resultado.sort(function(b, a) {
    return a.data - b.data;
  });

  function suaFuncao() {
    // Se a largura da tela for maior que 700 pixels
    if (window.innerWidth > 700) {
        for(let i = 0; i < listaOrdenada.length; i++){
            montaRegistrosVendas(
                listaOrdenada[i].avatar,
                listaOrdenada[i].nome,
                listaOrdenada[i].data,
                listaOrdenada[i].compra,
                listaOrdenada[i].quantidade,
                listaOrdenada[i].valorVenda,
                listaOrdenada[i].avatar,
                listaOrdenada[i].valorVenda
            )
        }
    } else {
        for(let i = 0; i < listaOrdenada.length; i++){
            montaRegistrosVendas(
                listaOrdenada[i].avatar,
                listaOrdenada[i].nome,
                listaOrdenada[i].data,
                listaOrdenada[i].compra,
                listaOrdenada[i].quantidade,
                listaOrdenada[i].valorVenda,
                listaOrdenada[i].avatar,
                listaOrdenada[i].valorVenda
            )
        }
    }
  }
  
  // Chamando suaFuncao quando a página é carregada
  window.onload = function() {

    const resultadosContainer = document.getElementById('vendas');
    // Limpa o conteúdo anterior
    resultadosContainer.innerHTML = '';
    
    suaFuncao();
  };
  
  // Chamando suaFuncao quando a janela é redimensionada
  window.onresize = function() {
    const resultadosContainer = document.getElementById('vendas');
    // Limpa o conteúdo anterior
    resultadosContainer.innerHTML = '';
    suaFuncao();
  };

function montaRegistrosVendas(avatar, nome, data, compra, quantidade, valorVenda){

    const areaVendas = document.querySelector('.vendas');

    let novaLinha = document.createElement("div");
    novaLinha.classList.add('linha');
    areaVendas.appendChild(novaLinha);

    //insere imagem usuario
    let usuarioAvatar = document.createElement("img");
    usuarioAvatar.src = avatar;
    usuarioAvatar.classList.add('img');
    //usuarioAvatar.classList.add('item');
    novaLinha.appendChild(usuarioAvatar);

    let pessoa = document.createElement("h1");
    let textoNome = document.createTextNode(`${nome}`);
    pessoa.classList.add('item');
    pessoa.appendChild(textoNome);
    novaLinha.appendChild(pessoa);

    const valorNumerico = data;
    const valorEmMilissegundos = 1706923541921 // 86.400.000 milissegundos em um dia
    const dataC = new Date(1970, 0, 1); // Época
    
    // Adicionando o valor em milissegundos ao objeto Date
    dataC.setTime(dataC.getTime() + valorEmMilissegundos);
    
    const dataFormatada = formatarDataParaString(dataC);
    console.log(dataFormatada);

    let dataCompra = document.createElement("p");
    let textoData = document.createTextNode(`Data da compra: ${dataFormatada}`);
    dataCompra.classList.add('item');
    dataCompra.appendChild(textoData);
    novaLinha.appendChild(dataCompra);

    let itemCompra = document.createElement("p");
    let textoCompra = document.createTextNode(`Item: ${compra}`);
    itemCompra.classList.add('item');
    itemCompra.appendChild(textoCompra);
    novaLinha.appendChild(itemCompra);

    let itemQuantidade = document.createElement("p");
    let textoQuantiade = document.createTextNode(`Quantidade: ${quantidade}`);
    itemQuantidade.classList.add('item');
    itemQuantidade.appendChild(textoQuantiade);
    novaLinha.appendChild(itemQuantidade);

    let vendaValor = document.createElement("p");
    let vendaTexto = document.createTextNode(`Valor de Venda R$${valorVenda}`);
    vendaValor.classList.add('item');
    vendaValor.appendChild(vendaTexto);
    novaLinha.appendChild(vendaValor);

}

function formatarDataParaString(data) {
    const dia = String(data.getDate()).padStart(2, '0');
    const mes = String(data.getMonth() + 1).padStart(2, '0'); // Adicionando 1 ao mês
    const ano = data.getFullYear();
  
    return `${dia}/${mes}/${ano}`;
  }
// VENDAS
let vendas = [{
    nome: 'Juliano',
    data: '2024-01-06',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Candida',
    data: '2024-01-06',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Kelly',
    data: '2024-01-07',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: '2024-01-19',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Carlinhos',
    data: '2024-01-19',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: '2024-01-19',
    compra: 'Trapiche',
    quantidade: 1,
    valorCompra: 45,
    valorVenda: 60
},
{
    nome: 'Carlinhos',
    data: '2024-01-19',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: '2024-01-20',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-01-21',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Candida',
    data: '2024-02-01',
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: '2024-02-09',
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: '2024-02-10',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: '2024-02-10',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: '2024-02-21',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Carlinhos',
    data: '2024-02-11',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Candice',
    data: '2024-02-11',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-02-11',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-03-02',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: '2024-03-13',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: '2024-03-13',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-03-25',
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: '2024-04-14',
    compra: 'Chac Chac - Rose',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: '2024-04-14',
    compra: 'Chac Chac - Rose',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: '2024-04-14',
    compra: 'Casillero Del Diablo',
    quantidade: 1,
    valorCompra: 45,
    valorVenda: 65
},
{
    nome: 'Carlinhos',
    data: '2024-04-14',
    compra: 'Granja União',
    quantidade: 1,
    valorCompra: 25,
    valorVenda: 35
},
{
    nome: 'Candice',
    data: '2024-04-09',
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: '2024-04-09',
    compra: 'Pack de Corona',
    quantidade: 1,
    valorCompra: 40,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: '2024-04-09',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlinhos',
    data: '2024-04-09',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: '2024-04-09',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: '2024-04-09',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: '2024-04-09',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Candida',
    data: '2024-04-20',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 45
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Granja União',
    quantidade: 1,
    valorCompra: 25,
    valorVenda: 35
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Tierruca',
    quantidade: 1,
    valorCompra: 30,
    valorVenda: 40
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Carlinhos',
    data: '2024-05-12',
    compra: 'Chac Chac - Branco',
    quantidade: 1,
    valorCompra: 22,
    valorVenda: 30
},
{
    nome: 'Candida',
    data: '2024-05-12',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Camille',
    data: '2024-05-12',
    compra: 'Reservado',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 35
},
{
    nome: 'Candida',
    data: '2024-05-12',
    compra: 'Garibaldi',
    quantidade: 1,
    valorCompra: 28,
    valorVenda: 35
},
{
    nome: 'Carlo',
    data: '2024-05-12',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlo',
    data: '2024-05-13',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlo',
    data: '2024-05-13',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Carlo',
    data: '2024-05-13',
    compra: 'Casa Silva',
    quantidade: 1,
    valorCompra: 35,
    valorVenda: 55
},
{
    nome: 'Candice',
    data: '2024-06-08',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-06-08',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: '2024-06-22',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candice',
    data: '2024-06-22',
    compra: 'Pack de heineken',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-06-29',
    compra: 'Piel de Lobo',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
},
{
    nome: 'Candida',
    data: '2024-06-29',
    compra: 'Piel de Lobo',
    quantidade: 1,
    valorCompra: 42,
    valorVenda: 50
}];

// INFO USUARIOS
let arrayObjetos = [{
    nome: 'Carlinhos',
    avatar: './img/carlinhos.jpeg',
    valorGasto: 825
},
{
    nome: 'Candida',
    avatar: './img/candida.jpeg',
    valorGasto: 450
},
{
    nome: 'Candice',
    avatar: './img/candice.jpeg',
    valorGasto: 790
},
{
    nome: 'Camille',
    avatar: './img/camille.png',
    valorGasto: 60
},
{
    nome: 'Juliano',
    avatar: './img/juliano.jpeg',
    valorGasto: 55
},
{
    nome: 'Kelly',
    avatar: './img/kelly.jpeg',
    valorGasto: 35
},
{
    nome: 'Lucas',
    avatar: './img/lucas.png',
    valorGasto: 0
},
{
    nome: 'Carlo',
    avatar: './img/carlo.png',
    valorGasto: 220
}]

function mesclarArrays(vendas, arrayObjetos, nome) {
    return vendas.map(objeto1 => {
        const objeto2 = arrayObjetos.find(objeto2 => objeto2[nome] === objeto1[nome]);

        // Se encontrou um objeto correspondente, mescla os objetos
        if (objeto2) {
            return { ...objeto1, ...objeto2 };
        }

        // Se não encontrou correspondência, retorna o objeto original
        return objeto1;
    });
}

const resultado = mesclarArrays(vendas, arrayObjetos, 'nome');

let listaOrdenada = resultado.sort(function(b, a) {
    return new Date(a.data) - new Date(b.data);
});

function suaFuncao() {
    const areaVendas = document.querySelector('.vendas');
    areaVendas.innerHTML = ''; // Limpa o conteúdo anterior

    for (let i = 0; i < listaOrdenada.length; i++) {
        montaRegistrosVendas(
            listaOrdenada[i].avatar,
            listaOrdenada[i].nome,
            listaOrdenada[i].data,
            listaOrdenada[i].compra,
            listaOrdenada[i].quantidade,
            listaOrdenada[i].valorVenda
        );
    }
}

// Chamando suaFuncao quando a página é carregada
window.onload = suaFuncao;

// Chamando suaFuncao quando a janela é redimensionada
window.onresize = suaFuncao;

function montaRegistrosVendas(avatar, nome, data, compra, quantidade, valorVenda) {
    const areaVendas = document.querySelector('.vendas');

    let novaLinha = document.createElement("div");
    novaLinha.classList.add('linha');
    areaVendas.appendChild(novaLinha);

    //insere imagem usuario
    let usuarioAvatar = document.createElement("img");
    usuarioAvatar.src = avatar;
    usuarioAvatar.classList.add('img');
    novaLinha.appendChild(usuarioAvatar);

    let pessoa = document.createElement("h1");
    let textoNome = document.createTextNode(`${nome}`);
    pessoa.classList.add('item');
    pessoa.appendChild(textoNome);
    novaLinha.appendChild(pessoa);

    // Converte a string da data para um objeto Date
    let dataVenda = new Date(data);
    let dataFormatada = formatarDataParaString(dataVenda);
    console.log(dataFormatada);

    let dataCompra = document.createElement("p");
    let textoData = document.createTextNode(`Data da compra: ${dataFormatada}`);
    dataCompra.classList.add('item');
    dataCompra.appendChild(textoData);
    novaLinha.appendChild(dataCompra);

    let itemCompra = document.createElement("p");
    let textoCompra = document.createTextNode(`Item: ${compra}`);
    itemCompra.classList.add('item');
    itemCompra.appendChild(textoCompra);
    novaLinha.appendChild(itemCompra);

    let itemQuantidade = document.createElement("p");
    let textoQuantiade = document.createTextNode(`Quantidade: ${quantidade}`);
    itemQuantidade.classList.add('item');
    itemQuantidade.appendChild(textoQuantiade);
    novaLinha.appendChild(itemQuantidade);

    let vendaValor = document.createElement("p");
    let vendaTexto = document.createTextNode(`Valor R$${valorVenda}`);
    vendaValor.classList.add('item');
    vendaValor.appendChild(vendaTexto);
    novaLinha.appendChild(vendaValor);
}

function formatarDataParaString(data) {
    const dia = String(data.getDate()).padStart(2, '0');
    const mes = String(data.getMonth() + 1).padStart(2, '0'); // Adicionando 1 ao mês
    const ano = data.getFullYear();

    return `${dia}/${mes}/${ano}`;
}